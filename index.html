<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Sample FirebaseUI App</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
    <!-- *******************************************************************************************
       * TODO(DEVELOPER): Paste the initialization snippet from this dialog box:
       * Firebase Console > Project Settings > Add App > Web.
       ***************************************************************************************** -->

    <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />

    <link type="text/css" href="/css/materialize.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link type="text/css" href="/css/styles.css" rel="stylesheet">
    <script type="text/javascript" src="/js/materialize.min.js"></script>
      
  </head>
  <body>
    <!-- The surrounding HTML is left untouched by FirebaseUI.
         Your app may use that space for branding, controls and other customizations.-->
    <div class="card-panel recipes container center">
      <div >Firebase PWA Sign in</div>
      <div id="firebaseui-auth-container"></div>
    </div>
    <script>
        // Initialize Firebase
        var config = {
          apiKey: "AIzaSyDuJe2w5Ptc1AwM-Us-kWb2jYJuCr6UTOw",
            authDomain: "angularfire-54a57.firebaseapp.com",
            databaseURL: "https://angularfire-54a57.firebaseio.com",
            projectId: "angularfire-54a57",
            storageBucket: "angularfire-54a57.appspot.com",
            messagingSenderId: "160774038322",
            appId: "1:160774038322:web:5325bf8caa01ee62cfad2b"
        };
        firebase.initializeApp(config);
        
        // make auth and firestore references
        //const auth = firebase.auth();
        //const db = firebase.firestore();
    
        // update firestore settings
        //db.settings({ timestampsInSnapshots: true });
      </script>

<script type="text/javascript">
    //var provider = new firebase.auth.GoogleAuthProvider();

    // FirebaseUI config.
    var uiConfig = {
      signInSuccessUrl: 'afterLogin.html',
      signInOptions: [
        // Leave the lines as is for the providers you want to offer your users.
        firebase.auth.GoogleAuthProvider.PROVIDER_ID,
        firebase.auth.FacebookAuthProvider.PROVIDER_ID,
        firebase.auth.TwitterAuthProvider.PROVIDER_ID,
        firebase.auth.GithubAuthProvider.PROVIDER_ID,
        firebase.auth.EmailAuthProvider.PROVIDER_ID,
        firebase.auth.PhoneAuthProvider.PROVIDER_ID,
        firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID
      ],
      // tosUrl and privacyPolicyUrl accept either url string or a callback
      // function.
      // Terms of service url/callback.
      tosUrl: '<your-tos-url>',
      // Privacy policy url/callback.
      privacyPolicyUrl: function() {
        window.location.assign('<your-privacy-policy-url>');
      }
    };

    initApp = function() {
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        console.log('already login'+window.location.origin);
        window.location.replace("https://majestic-sable-521f65.netlify.app/afterLogin.html");
        // User is signed in.
        //document.getElementById('sign-out').style.display = 'block';
        /* var displayName = user.displayName;
        var email = user.email;
        var emailVerified = user.emailVerified;
        var photoURL = user.photoURL;
        var uid = user.uid;
        var phoneNumber = user.phoneNumber;
        var providerData = user.providerData;
        user.getIdToken().then(function(accessToken) {
          document.getElementById('sign-in-status').textContent = 'Signed in';
          document.getElementById('sign-in').textContent = 'Sign out';
          document.getElementById('account-details').textContent = JSON.stringify({
            displayName: displayName,
            email: email,
            emailVerified: emailVerified,
            phoneNumber: phoneNumber,
            photoURL: photoURL,
            uid: uid,
            accessToken: accessToken,
            providerData: providerData
          }, null, '  ');
        }); */
      } else {
        // User is signed out. then show login ui
        // Initialize the FirebaseUI Widget using Firebase.
        console.log(' to login');
        var ui = new firebaseui.auth.AuthUI(firebase.auth());
        // The start method will wait until the DOM is loaded.
        ui.start('#firebaseui-auth-container', uiConfig);
            
      }
    }, function(error) {
      console.log(error);
    });
  };

  window.addEventListener('load', function() {
    initApp()
  });

    
  </script>
  </body>
</html>